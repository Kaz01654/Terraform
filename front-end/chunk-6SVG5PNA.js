import{a as Pt}from"./chunk-THIWD27P.js";import{a as Vt}from"./chunk-WAPBH432.js";import{a as Mt}from"./chunk-XHNQRRQK.js";import{a as Ft,b as k}from"./chunk-P4PAYY2C.js";import{d as ut,e as _t,f as bt,g as Ct,i as yt,j as xt,k as Tt,m as St,p as Et}from"./chunk-A6SNVUCE.js";import{a as st,b as lt,c as pt,d as ct,g as dt,h as mt,k as ht,l as gt,o as ft,r as wt,s as vt}from"./chunk-TWZKI4VX.js";import{a as Nt}from"./chunk-V45YFJOR.js";import{b as Q,d as tt,e as et,f as it,o as ot,r as at,y as nt,z as rt}from"./chunk-VE3AD5Y3.js";import{h as $,i as J,j as Z,k as H,m as q,n as Y,p as K}from"./chunk-QSIHMZNO.js";import{Cb as C,Db as h,Gb as G,Mb as X,Nb as b,Ob as I,Pb as S,Rb as M,Sb as F,Tb as P,Vb as R,Wb as y,Ya as p,Yb as O,Za as B,Zb as z,dc as x,e as Dt,ec as U,f as _,fc as E,ia as j,jb as V,mb as W,nb as m,qb as N,sa as g,ta as f,tb as n,ub as r,vb as w,zb as v}from"./chunk-II3ZEASU.js";var Gt=Dt(Nt());var Ot=()=>({"min-width":"50rem"}),Lt=()=>[5,10,20,50,100],At=()=>["descripcion","valor","cantidad","fecha_op","total"],jt=()=>({width:"50vw"}),Wt=()=>({"960px":"75vw"}),Xt=()=>({width:"130%",float:"right"}),Bt=(a,u)=>({gasto:a,ingreso:u}),L=()=>({width:"2.5rem",height:"2.5rem"}),Rt=(a,u,o)=>({gasto:a,ingreso:u,neutral:o});function zt(a,u){if(a&1){let o=v();n(0,"p-button",38),C("onClick",function(){g(o);let t=h(2);return f(t.descargarCSV(t.info,"Informe"))}),r()}if(a&2){let o=h(2);m("disabled",o.loading)}}function Ut(a,u){if(a&1){let o=v();n(0,"p-button",39),C("onClick",function(){g(o);let t=h(2);return f(t.descargarExcel())}),r()}if(a&2){let o=h(2);m("disabled",o.loading)}}function $t(a,u){if(a&1){let o=v();n(0,"div",30)(1,"span",31),w(2,"i",32),n(3,"input",33),C("input",function(t){g(o),h();let i=X(2);return f(i.filterGlobal(t.target.value,"contains"))}),r()(),n(4,"div")(5,"p-calendar",34),P("ngModelChange",function(t){g(o);let i=h();return F(i.fecha_datos,t)||(i.fecha_datos=t),f(t)}),C("onSelect",function(t){g(o);let i=h();return f(i.poblarTabla(t))})("onClearClick",function(t){g(o);let i=h();return f(i.poblarTabla(t.target.value))}),r(),n(6,"p-button",35),C("onClick",function(){g(o);let t=h();return f(t.open("Gasto"))}),r(),V(7,zt,1,1,"p-button",36)(8,Ut,1,1,"p-button",37),r()()}if(a&2){let o=h();p(5),M("ngModel",o.fecha_datos),m("showIcon",!0)("showButtonBar",!0)("monthNavigator",!0)("yearNavigator",!0)("readonlyInput",!0)("showTransitionOptions","0ms")("hideTransitionOptions","0ms"),p(),m("disabled",o.loading),p(),m("ngIf",o.info),p(),m("ngIf",o.info)}}function Jt(a,u){if(a&1&&(n(0,"th",41),b(1),w(2,"p-sortIcon",42),r()),a&2){let o=u.$implicit;G("pSortableColumn",o.field),p(),S("",o.header," "),p(),G("field",o.field)}}function Zt(a,u){if(a&1&&(n(0,"tr"),V(1,Jt,3,3,"th",40),r()),a&2){let o=u.$implicit;p(),m("ngForOf",o)}}function Ht(a,u){if(a&1){let o=v();n(0,"p-button",48),C("onClick",function(){g(o);let t=h().$implicit,i=h();return f(i.openCoPoUpdate(t))}),r()}a&2&&m("rounded",!0)}function qt(a,u){if(a&1){let o=v();n(0,"p-button",48),C("onClick",function(){g(o);let t=h().$implicit,i=h();return f(i.openUpdate(t))}),r()}a&2&&m("rounded",!0)}function Yt(a,u){if(a&1){let o=v();n(0,"p-button",48),C("onClick",function(){g(o);let t=h().$implicit,i=h();return f(i.openProdUpdate(t))}),r()}a&2&&m("rounded",!0)}function Kt(a,u){if(a&1){let o=v();n(0,"tr",43)(1,"td",44),b(2),r(),n(3,"td",44),b(4),r(),n(5,"td",44)(6,"div",45),b(7),x(8,"number"),r()(),n(9,"td",44)(10,"div",45),b(11),x(12,"number"),r()(),n(13,"td",44),b(14),x(15,"date"),r(),n(16,"td",44),b(17),x(18,"date"),r(),n(19,"td",44),V(20,Ht,1,1,"p-button",46)(21,qt,1,1,"p-button",46)(22,Yt,1,1,"p-button",46),n(23,"p-button",47),C("onClick",function(){let t=g(o).$implicit,i=h();return f(i.deleteGasto(t.id))}),r()()()}if(a&2){let o=u.$implicit;p(2),I(o.descripcion),p(2),I(o.cantidad),p(2),m("ngClass",O(23,Bt,o.tipo===2,o.tipo===1)),p(),S(" L. ",E(8,12,o.valor,"1.2-2")," "),p(3),m("ngClass",O(26,Bt,o.tipo===2,o.tipo===1)),p(),S(" L. ",E(12,15,o.total,"1.2-2")," "),p(3),I(E(15,18,o.fecha_op,"yyyy-MM-dd")),p(3),I(U(18,21,o.fecha_registro)),p(3),m("ngIf",o.categoria===3||o.categoria===4),p(),m("ngIf",o.categoria===2||o.categoria===5||o.categoria===6),p(),m("ngIf",o.categoria===1),p(),m("rounded",!0)}}function Qt(a,u){if(a&1&&(n(0,"tr")(1,"td")(2,"h4"),b(3,"No hay datos"),r()()()),a&2){let o=u.$implicit;p(),W("colspan",o.length)}}function te(a,u){if(a&1&&(n(0,"div",49)(1,"div",50)(2,"div",51)(3,"div",52)(4,"div")(5,"span",53),b(6,"Facturaci\xF3n"),r(),n(7,"div",54),b(8),x(9,"number"),r()(),n(10,"div",55),w(11,"i",56),r()()()(),n(12,"div",50)(13,"div",51)(14,"div",52)(15,"div")(16,"span",53),b(17,"Gastos"),r(),n(18,"div",54),b(19),x(20,"number"),r()(),n(21,"div",57),w(22,"i",58),r()()()(),n(23,"div",59)(24,"div",51)(25,"div",52)(26,"div")(27,"span",53),b(28,"Total Ingresos"),r(),n(29,"div",60),b(30),x(31,"number"),r()(),n(32,"div")(33,"span",53),b(34,"Total Gastos"),r(),n(35,"div",60),b(36),x(37,"number"),r()(),n(38,"div")(39,"span",53),b(40,"Ganancia o P\xE9rdida"),r(),n(41,"div",60),b(42),x(43,"number"),r()(),n(44,"div",61),w(45,"i",62),r()()()()()),a&2){let o=h();p(8),S("L. ",E(9,11,o.total_facts,"1.2-2"),""),p(2),m("ngStyle",y(26,L)),p(9),S("L. ",E(20,14,o.total_gast,"1.2-2"),""),p(2),m("ngStyle",y(27,L)),p(8),m("ngClass","ingreso"),p(),S("L. ",E(31,17,o.total_facts,"1.2-2"),""),p(5),m("ngClass","gasto"),p(),S("L. ",E(37,20,o.total_gastos,"1.2-2"),""),p(5),m("ngClass",z(28,Rt,o.total_facts<o.total_gastos,o.total_facts>o.total_gastos,o.total_facts==o.total_gastos)),p(),S("L. ",E(43,23,o.total_facts-o.total_gastos,"1.2-2"),""),p(2),m("ngStyle",y(32,L))}}function ee(a,u){if(a&1&&(n(0,"div",63)(1,"h4"),b(2),r()()),a&2){let o=h();p(2),I(o.titleModal)}}function ie(a,u){if(a&1){let o=v();n(0,"p-button",68),C("onClick",function(){g(o);let t=h(2);return f(t.agregarGasto())}),r()}if(a&2){let o=h(2);G("label",o.textBottom),m("raised",!0)}}function oe(a,u){if(a&1){let o=v();n(0,"p-button",69),C("onClick",function(){g(o);let t=h(2);return f(t.editarGasto())}),r()}if(a&2){let o=h(2);G("label",o.textBottom),m("raised",!0)}}function ae(a,u){if(a&1){let o=v();V(0,ie,1,2,"p-button",64)(1,oe,1,2,"p-button",65),n(2,"p-button",66),C("onClick",function(){g(o);let t=h();return f(t.clean())}),r(),n(3,"p-button",67),C("onClick",function(){g(o);let t=h();return f(t.closeDialog())}),r()}if(a&2){let o=h();m("ngIf",o.op=="Add"),p(),m("ngIf",o.op=="Edit"),p(),G("label",o.btnClean),m("raised",!0),p(),m("raised",!0)}}var l=Gt.default.mixin({showClass:{popup:`
      animate__animated
      animate__fadeInUp
      animate__faster
    `},hideClass:{popup:`
      animate__animated
      animate__fadeOutDown
      animate__faster
    `}}),Ie=(()=>{let u=class u{constructor(e,t,i,s,c){this.api=e,this.apiProd=t,this.apiFactura=i,this.spinner=s,this.primengConfig=c,this.fileName="Informe.xlsx",this.filas=0,this.columnas=[],this.info=[],this.infoProd=[],this.listProd=[],this.prod=null,this.loading=!1,this.titleModal="Agregar Gasto",this.textBottom="Agregar",this.lbBtnModal="Cancelar",this.btnClean="Limpiar",this.op="Add",this.total_prod=0,this.total_var=0,this.total_copy=0,this.total_plot=0,this.total_comp=0,this.total_gast=0,this.total_ing=0,this.total_facts=0,this.total_gastos=0,this.total_resultado=0,this.tipo_global=0,this.cat_global=0,this.visible=!1,this.total_input=!0,this.id=0,this.desc="",this.cant=1,this.fecha_op=new Date,this.primengConfig.setTranslation({dayNames:["Domingo","Lunes","Martes","Mi\xE9rcoles","Jueves","Viernes","S\xE1bado"],dayNamesShort:["Dom","Lun","Mar","Mi\xE9","Jue","Vie","S\xE1b"],dayNamesMin:["Do","Lu","Ma","Mi","Ju","Vi","Sa"],monthNames:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],monthNamesShort:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],today:"Hoy",clear:"Todos los registros"}),this.filas=10,this.columnas=[{field:"descripcion",header:"Descripcion"},{field:"cantidad",header:"Cantidad"},{field:"valor",header:"Valor"},{field:"total",header:"Total"},{field:"fecha_op",header:"Fecha OP"},{field:"fecha_registro",header:"Fecha Registro"},{field:"",header:"Acciones"}]}ngOnInit(){return _(this,null,function*(){this.primengConfig.ripple=!0,this.load(!0),yield this.getProd(),yield this.poblarTabla(),this.load(!1)})}calculos(e){this.total_prod=this.total_var=this.total_copy=this.total_plot=this.total_comp=this.total_gast=this.total_gastos=this.total_ing=this.total_resultado=0,e.forEach(t=>{switch(t.categoria){case 1:this.total_prod+=t.total;break;case 2:this.total_var+=t.total;break;case 3:this.total_copy+=t.total;break;case 4:this.total_plot+=t.total;break;case 5:this.total_comp+=t.total;break;default:this.total_gast+=t.total;break}}),this.total_ing=this.total_prod+this.total_copy+this.total_plot+this.total_var,this.total_gastos=this.total_gast+this.total_comp,this.total_resultado=Math.abs(this.total_ing-this.total_gastos)}prodControl(e,t){return _(this,null,function*(){this.load(!0),this.apiProd.prodControl(e,t).subscribe(i=>{l.fire({position:"bottom-end",icon:"success",title:i.mgs,showConfirmButton:!1,timer:2e3,toast:!0}),this.getProd()},i=>{l.fire("Error!",`${i.message}`,"error")},()=>this.load(!1))})}poblarTabla(e=void 0){return _(this,null,function*(){this.fecha_datos=e,this.load(!0),this.getTotalFacturas(e),e==null||e==""?this.api.getGastos().subscribe(t=>_(this,null,function*(){this.info=yield t,this.calculos(this.info)}),t=>{l.fire("Error!",`${t.message}`,"error")},()=>this.load(!1)):this.api.getGastosByDate(this.formatearFecha(e).fecha).subscribe(t=>_(this,null,function*(){this.info=yield t,this.calculos(this.info)}),t=>{l.fire("Error!",`${t.message}`,"error")},()=>this.load(!1))})}getTotalFacturas(e=void 0){return _(this,null,function*(){this.load(!0),e==null||e==""?this.apiFactura.getFacturas().subscribe(t=>_(this,null,function*(){this.total_facts=t.reduce((i,s)=>i+s.total_fact,0)}),t=>{l.fire("Error!",`${t.message}`,"error")},()=>this.load(!1)):this.apiFactura.getFacturasByDate(this.formatearFecha(e).fecha).subscribe(t=>_(this,null,function*(){this.total_facts=t.reduce((i,s)=>i+s.total_fact,0)}),t=>{l.fire("Error!",`${t.message}`,"error")},()=>this.load(!1))})}getProd(){return _(this,null,function*(){this.load(!0),this.listProd=[{label:"Seleccione Producto",value:null}],this.apiProd.getProducts().subscribe(e=>_(this,null,function*(){this.infoProd=yield e;for(let t=0;t<e.length;t++)this.listProd.push({label:e[t].nombre_prod+" - "+e[t].cant_prod,value:e[t].id_prod});this.prod=this.listProd[0].value}),e=>{l.fire("Error!",`${e.message}`,"error")},()=>this.load(!1))})}operationCant(e){e&&(this.total=this.valor*e.value)}operationVal(e){e&&(this.total=this.cant*e.value)}open(e){this.clean(),this.titleModal="Agregar "+e,this.textBottom="Agregar",this.op="Add",this.tipo_global=e=="Variado"?1:2,this.cat_global=e=="Variado"?2:e=="Compra"?5:6,this.showDialog()}openUpdate(e){this.titleModal="Editar Variado",this.textBottom="Editar",this.op="Edit",this.id=e.id,this.desc=e.descripcion,this.valor=e.valor,this.total=e.total,this.tipo=e.tipo,this.cat=e.categoria,this.cant=e.cantidad,this.fecha_op=new Date(e.fecha_op),this.showDialog()}openCopy(){return _(this,null,function*(){let e=yield l.fire({title:"Agregue cantidad de copias",input:"number",inputPlaceholder:"Cantidad",inputAttributes:{"aria-label":"Cantidad",min:"1",max:"9999"},inputValue:1,confirmButtonText:"Guardar",showCancelButton:!0,allowOutsideClick:!1});if(e.isConfirmed)if(e.value<=0)l.fire("Cuidado!","La cantidad de copias no puede ser menor o igual a cero!","warning");else{let t={descripcion:"Copias",cantidad:e.value,valor:1,total:e.value*1,tipo:1,categoria:3,fecha_op:this.formatearFecha(this.fecha_op).completo};this.load(!0),this.api.insertGasto(t).subscribe(i=>{i.status?l.fire({position:"top-end",icon:"success",title:i.mgs,showConfirmButton:!1,timer:2e3}).then(()=>_(this,null,function*(){yield this.poblarTabla(this.fecha_datos)})):l.fire("Cuidado!",i.mgs,"warning")},i=>{l.fire("Error!",`${i.message}`,"error")},()=>(this.load(!1),this.closeDialog()))}})}openPlotter(){return _(this,null,function*(){let e=yield l.fire({title:"Agregue cantidad de plotter",input:"number",inputPlaceholder:"Cantidad",inputAttributes:{"aria-label":"Cantidad",min:"1",max:"9999"},inputValue:1,confirmButtonText:"Guardar",showCancelButton:!0,allowOutsideClick:!1});if(e.isConfirmed)if(e.value<=0)l.fire("Cuidado!","La cantidad de plotter no puede ser menor o igual a cero!","warning");else{let t={descripcion:"Plotter",cantidad:e.value,valor:70,total:e.value*70,tipo:1,categoria:4,fecha_op:this.formatearFecha(this.fecha_op).completo};this.load(!0),this.api.insertGasto(t).subscribe(i=>{i.status?l.fire({position:"top-end",icon:"success",title:i.mgs,showConfirmButton:!1,timer:2e3}).then(()=>_(this,null,function*(){yield this.poblarTabla(this.fecha_datos)})):l.fire("Cuidado!",i.mgs,"warning")},i=>{l.fire("Error!",`${i.message}`,"error")},()=>(this.load(!1),this.closeDialog()))}})}openCoPoUpdate(e){return _(this,null,function*(){let t=yield l.fire({title:"Edite la cantidad de "+e.descripcion,input:"number",inputPlaceholder:"Cantidad",inputAttributes:{"aria-label":"Cantidad",min:"1",max:"9999"},inputValue:e.cantidad,confirmButtonText:"Guardar",showCancelButton:!0,allowOutsideClick:!1});if(t.isConfirmed)if(t.value<=0)l.fire("Cuidado!","La cantidad de "+e.descripcion+" no puede ser menor o igual a cero!","warning");else{let i={descripcion:e.descripcion,cantidad:t.value,valor:e.categoria==3?1:70,total:t.value*(e.categoria==3?1:70),tipo:e.tipo,categoria:e.categoria,fecha_op:this.formatearFecha(new Date(e.fecha_op)).completo};this.load(!0),this.api.updateGasto(e.id,i).subscribe(s=>{s.status?l.fire({position:"top-end",icon:"success",title:s.mgs,showConfirmButton:!1,timer:2e3}).then(()=>_(this,null,function*(){yield this.poblarTabla(this.fecha_datos)})):l.fire("Cuidado!",s.mgs,"warning")},s=>{l.fire("Error!",`${s.message}`,"error")},()=>(this.load(!1),this.closeDialog()))}})}openProdUpdate(e){return _(this,null,function*(){let t=this.infoProd[this.infoProd.findIndex(s=>s.nombre_prod==e.descripcion)],i=yield l.fire({title:"Edite la cantidad de "+t.nombre_prod,input:"number",inputPlaceholder:"Cantidad",inputAttributes:{"aria-label":"Cantidad",min:"1",max:t.cant_prod+e.cantidad},inputValue:e.cantidad,validationMessage:"La cantidad ingresada sobrepasa lo que hay en existencia!",confirmButtonText:"Guardar",showCancelButton:!0,allowOutsideClick:!1});if(i.isConfirmed)if(i.value<=0)l.fire("Cuidado!","La cantidad de "+t.nombre_prod+" no puede ser menor o igual a cero!","warning");else{let s={descripcion:t.nombre_prod,cantidad:i.value,valor:parseFloat(t.precio_prod)*t.impuesto+parseFloat(t.ganancia_prod)+parseFloat(t.precio_prod),total:(parseFloat(t.precio_prod)*t.impuesto+parseFloat(t.ganancia_prod)+parseFloat(t.precio_prod))*Number(i.value),tipo:e.tipo,categoria:e.categoria,fecha_op:this.formatearFecha(new Date(e.fecha_op)).completo};this.load(!0),this.api.updateGasto(e.id,s).subscribe(c=>{c.status?l.fire({position:"top-end",icon:"success",title:c.mgs,showConfirmButton:!1,timer:2e3}).then(()=>_(this,null,function*(){yield this.poblarTabla(this.fecha_datos),yield this.prodControl(t.id_prod,t.cant_prod+e.cantidad-i.value),this.clean()})):l.fire("Cuidado!",c.mgs,"warning")},c=>{l.fire("Error!",`${c.message}`,"error")},()=>(this.load(!1),this.closeDialog()))}})}agregarGasto(){return _(this,null,function*(){if(this.desc==""||this.fecha_op==null||this.valor==null||this.cant==0)l.fire({position:"bottom-end",icon:"warning",title:"Debe llenar todos los campos!",showConfirmButton:!1,timer:2e3,toast:!0});else{let e={descripcion:this.desc,cantidad:this.cant,valor:this.valor,total:this.total,tipo:this.tipo_global,categoria:this.cat_global,fecha_op:this.formatearFecha(this.fecha_op).completo};this.load(!0),this.api.insertGasto(e).subscribe(t=>{t.status?l.fire({position:"top-end",icon:"success",title:t.mgs,showConfirmButton:!1,timer:2e3}).then(()=>_(this,null,function*(){yield this.poblarTabla(this.fecha_datos),this.clean()})):l.fire("Cuidado!",t.mgs,"warning")},t=>{l.fire("Error!",`${t.message}`,"error")},()=>(this.load(!1),this.closeDialog()))}})}editarGasto(){return _(this,null,function*(){if(this.desc==""||this.fecha_op==null||this.valor==null||this.cant==0)l.fire({position:"bottom-end",icon:"warning",title:"Debe llenar todos los campos!",showConfirmButton:!1,timer:2e3,toast:!0});else{let e={descripcion:this.desc,cantidad:this.cant,valor:this.valor,total:this.total,tipo:this.tipo,categoria:this.cat,fecha_op:this.formatearFecha(this.fecha_op).completo};this.load(!0),this.api.updateGasto(this.id,e).subscribe(t=>{t.status?l.fire({position:"top-end",icon:"success",title:t.mgs,showConfirmButton:!1,timer:2e3}).then(()=>_(this,null,function*(){yield this.poblarTabla(this.fecha_datos),this.clean()})):l.fire("Cuidado!",t.mgs,"warning")},t=>{l.fire("Error!",`${t.message}`,"error")},()=>(this.load(!1),this.closeDialog()))}})}deleteGasto(e){return _(this,null,function*(){l.fire({title:"Esta seguro de realizar esta accion?",text:"Se va a eliminar la operacion!",icon:"warning",showCancelButton:!0,confirmButtonText:"Eliminar",confirmButtonColor:"#d33",cancelButtonText:"Cancelar",cancelButtonColor:"#B9B6B5"}).then(t=>_(this,null,function*(){t.value&&(this.load(!0),this.api.deleteGasto(e).subscribe(i=>{i.status?l.fire({position:"top-end",icon:"success",title:i.mgs,showConfirmButton:!1,timer:2e3}).then(()=>_(this,null,function*(){if(i.data.categoria==1){let s=this.infoProd[this.infoProd.findIndex(c=>c.nombre_prod==i.data.descripcion)];yield this.prodControl(s.id_prod,s.cant_prod+i.data.cantidad)}})):l.fire("Cuidado!",i.mgs,"warning")},i=>{l.fire("Error!",`${i.message}`,"error")},()=>(this.poblarTabla(this.fecha_datos),this.load(!1),this.closeDialog())))}))})}agregarProd(e){return _(this,null,function*(){if(e){let t=yield this.infoProd[this.infoProd.findIndex(i=>i.id_prod==e)];t.cant_prod?l.fire({title:"Agregue la cantidad de "+t.nombre_prod,input:"number",inputPlaceholder:"Cantidad",inputAttributes:{"aria-label":"Cantidad",min:"1",max:t.cant_prod},inputValue:1,validationMessage:"La cantidad ingresada sobrepasa lo que hay en existencia!",confirmButtonText:"Guardar",showCancelButton:!0,allowOutsideClick:!1}).then(i=>{if(i.isConfirmed){let s={descripcion:t.nombre_prod,cantidad:i.value,valor:parseFloat(t.precio_prod)*t.impuesto+parseFloat(t.ganancia_prod)+parseFloat(t.precio_prod),total:(parseFloat(t.precio_prod)*t.impuesto+parseFloat(t.ganancia_prod)+parseFloat(t.precio_prod))*Number(i.value),tipo:1,categoria:1,fecha_op:this.formatearFecha(this.fecha_op).fecha};this.load(!0),this.api.insertGasto(s).subscribe(c=>{c.status?l.fire({position:"top-end",icon:"success",title:c.mgs,showConfirmButton:!1,timer:2e3}).then(()=>_(this,null,function*(){yield this.poblarTabla(this.fecha_datos),yield this.prodControl(t.id_prod,t.cant_prod-c.data.cantidad),this.clean()})):l.fire("Cuidado!",c.mgs,"warning")},c=>{l.fire("Error!",`${c.message}`,"error")},()=>(this.load(!1),this.closeDialog()))}else i.isDenied&&l.fire("Cambios no guardados!","","info")}):l.fire("Cuidado!",`El producto ${t.nombre_prod} no tiene unidades en existencia!`,"warning")}})}ConvertToCSV(e,t,i){let s=typeof e!="object"?JSON.parse(e):e,c="",d="";for(let T in t)d+=t[T]+", ";d=d.replace(/,\s*$/,""),c+=d+`\r
`;for(let T=0;T<s.length;T++){let D="",A=0;for(let It in i){let kt=i[It];D+=(A!=0?", ":"")+s[T][kt],A++}c+=D+`\r
`}return c}descargarCSV(e,t="data"){let i=this.ConvertToCSV(e,["Descripcion","Cantidad","Valor","Total","Fecha Operacion","Fecha Registro"],["descripcion","cantidad","valor","total","fecha_op","fecha_registro"]),s=new Blob(["\uFEFF"+i],{type:"text/csvcharset=utf-8"}),c=document.createElement("a"),d=URL.createObjectURL(s);navigator.userAgent.indexOf("Safari")!=-1&&navigator.userAgent.indexOf("Chrome")==-1&&c.setAttribute("target","_blank"),c.setAttribute("href",d),c.setAttribute("download",t+".csv"),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c)}descargarExcel(){let e=new Array;this.info.forEach(s=>{let c={descripcion:s.descripcion,cantidad:s.cantidad,valor:s.valor,total:s.total,tipo:s.tipo_desc,fecha_op:this.formatearFecha(new Date(s.fecha_op)).fecha,fecha_registro:this.formatearFecha(new Date(s.fecha_registro)).fecha};e.push(c)});let t=k.json_to_sheet(e);t.A1.v="Descripcion",t.B1.v="Cantidad",t.C1.v="Valor",t.D1.v="Total",t.E1.v="Tipo",t.F1.v="Fecha Operacion",t.G1.v="Fecha Registro";let i=k.book_new();k.book_append_sheet(i,t,"Informe Operaciones"),Ft(i,this.fileName)}formatearFecha(e){let t=this.addZero(e.getHours()),i=this.addZero(e.getMinutes()),s=this.addZero(e.getSeconds()),c=e.getFullYear(),d=this.addZero(e.getMonth()+1),T=this.addZero(e.getDate());return{completo:c+"-"+d+"-"+T+" "+t+":"+i+":"+s,fecha:c+"-"+d+"-"+T,hora:t+":"+i+":"+s}}addZero(e){return e<10&&(e="0"+e),e}clean(){this.desc="",this.valor=void 0,this.total=void 0,this.cant=1,this.prod=this.listProd[0].value,this.fecha_op=new Date}showDialog(){this.visible=!0}closeDialog(){this.visible=!1}load(e){e?(this.loading=!0,this.spinner.show()):(this.loading=!1,this.spinner.hide())}};u.\u0275fac=function(t){return new(t||u)(B(Pt),B(Mt),B(Vt),B(st),B(ot))},u.\u0275cmp=j({type:u,selectors:[["app-gastos"]],standalone:!0,features:[R],decls:38,vars:45,consts:[["dt",""],[1,"card",2,"text-align","center"],["styleClass","p-datatable-gridlines p-datatable-striped","columnResizeMode","expand","currentPageReportTemplate","Mostrando {first} a {last} de {totalRecords} datos","scrollHeight","20%",3,"tableStyle","value","rows","loading","columns","paginator","showCurrentPageReport","resizableColumns","rowsPerPageOptions","globalFilterFields"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","summary"],["bdColor","rgba(0, 0, 0, 0.8)","size","large","color","#fff","type","ball-atom",3,"fullScreen"],["header","Header",3,"visibleChange","visible","modal","baseZIndex","breakpoints","draggable","resizable"],["ng-template","","pTemplate","header"],[1,"p-fluid","p-formgrid","grid"],[1,"field","col-12","md:col-6"],[1,"p-inputgroup"],["tooltipPosition","bottom","pTooltip","Descripcion",1,"p-inputgroup-addon"],[1,"pi","pi-info-circle"],["type","text","pInputText","","placeholder","Descripcion",3,"ngModelChange","ngModel"],["tooltipPosition","bottom","pTooltip","Fecha compra",1,"p-inputgroup-addon"],[1,"pi","pi-calendar-times"],["dateFormat","yy-mm-dd","yearRange","2000:2050","placeholder","XXXX-XX-XX","appendTo","body",3,"ngModelChange","ngModel","showIcon","showButtonBar","monthNavigator","yearNavigator","readonlyInput","showTransitionOptions","hideTransitionOptions"],[1,"field","col-12","md:col-4"],["tooltipPosition","bottom","pTooltip","Cantidad",1,"p-inputgroup-addon"],[1,"pi","pi-plus-circle"],["placeholder","Cantidad",3,"ngModelChange","onInput","showButtons","min","max","ngModel"],["tooltipPosition","bottom","pTooltip","Valor",1,"p-inputgroup-addon"],[1,"pi","pi-money-bill"],["mode","decimal","locale","en-US","placeholder","Valor",3,"ngModelChange","onInput","minFractionDigits","ngModel"],["tooltipPosition","bottom","pTooltip","Total",1,"p-inputgroup-addon"],["mode","decimal","locale","en-US","placeholder","Total",3,"ngModelChange","minFractionDigits","ngModel","disabled"],["pTemplate","footer"],[1,"mr-3",2,"display","flex"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["type","text","pInputText","","size","20","placeholder","B\xFAsqueda...",2,"width","auto!important",3,"input"],["dateFormat","yy-mm-dd","yearRange","2000:2050","placeholder","Todos los registros","appendTo","body",1,"margen",3,"ngModelChange","onSelect","onClearClick","ngModel","showIcon","showButtonBar","monthNavigator","yearNavigator","readonlyInput","showTransitionOptions","hideTransitionOptions"],["icon","pi pi-money-bill","iconPos","left","label","Gastos","pTooltip","Agregar Gasto","tooltipPosition","bottom","severity","danger",1,"margen",3,"onClick","disabled"],["icon","pi pi-file","class","margen","pTooltip","Descargar CSV","tooltipPosition","bottom","severity","secondary",3,"disabled","onClick",4,"ngIf"],["icon","pi pi-file-excel","class","margen","pTooltip","Descargar Excel","tooltipPosition","bottom","severity","success",3,"disabled","onClick",4,"ngIf"],["icon","pi pi-file","pTooltip","Descargar CSV","tooltipPosition","bottom","severity","secondary",1,"margen",3,"onClick","disabled"],["icon","pi pi-file-excel","pTooltip","Descargar Excel","tooltipPosition","bottom","severity","success",1,"margen",3,"onClick","disabled"],["pResizableColumn","","style","width: 11em","class","text-center",3,"pSortableColumn",4,"ngFor","ngForOf"],["pResizableColumn","",1,"text-center",2,"width","11em",3,"pSortableColumn"],[3,"field"],[1,"animate__animated","animate__fadeInLeft"],[1,"text-center"],[3,"ngClass"],["pTooltip","Editar Operacion","tooltipPosition","bottom","icon","pi pi-pencil","class","margen2","severity","success",3,"rounded","onClick",4,"ngIf"],["pTooltip","Eliminar Operacion","tooltipPosition","bottom","icon","pi pi-trash","severity","danger",1,"margen2",3,"onClick","rounded"],["pTooltip","Editar Operacion","tooltipPosition","bottom","icon","pi pi-pencil","severity","success",1,"margen2",3,"onClick","rounded"],[1,"grid"],[1,"col-12","lg:col-6","xl:col-3"],[1,"card","mb-0"],[1,"flex","justify-content-between","mb-3"],[1,"block","text-500","font-medium","mb-3"],[1,"text-900","font-medium","text-xl"],[1,"flex","align-items-center","justify-content-center","bg-green-100","border-round",3,"ngStyle"],[1,"pi","pi-wallet","text-green-500","text-xl"],[1,"flex","align-items-center","justify-content-center","bg-red-100","border-round",3,"ngStyle"],[1,"pi","pi-money-bill","text-red-500","text-xl"],[1,"col-12","lg:col-6","xl:col-6"],[1,"font-medium","text-xl",3,"ngClass"],[1,"flex","align-items-center","justify-content-center","bg-yellow-100","border-round",3,"ngStyle"],[1,"pi","pi-calculator","text-yellow-500","text-xl"],[1,"inline-flex","align-items-center","justify-content-center","gap-2"],["icon","pi pi-check","severity","primary",3,"raised","label","onClick",4,"ngIf"],["icon","pi pi-search","severity","success",3,"raised","label","onClick",4,"ngIf"],["icon","pi pi-eraser","severity","secondary",3,"onClick","raised","label"],["icon","pi pi-times","label","Cancelar","severity","danger",3,"onClick","raised"],["icon","pi pi-check","severity","primary",3,"onClick","raised","label"],["icon","pi pi-search","severity","success",3,"onClick","raised","label"]],template:function(t,i){if(t&1){let s=v();n(0,"div",1)(1,"p-table",2,0),V(3,$t,9,11,"ng-template",3)(4,Zt,2,1,"ng-template",4)(5,Kt,24,29,"ng-template",5)(6,Qt,4,1,"ng-template",6)(7,te,46,33,"ng-template",7),r()(),w(8,"ngx-spinner",8),n(9,"p-dialog",9),P("visibleChange",function(d){return g(s),F(i.visible,d)||(i.visible=d),f(d)}),V(10,ee,3,1,"ng-template",10),n(11,"div",11)(12,"div",12)(13,"div",13)(14,"span",14),w(15,"i",15),r(),n(16,"input",16),P("ngModelChange",function(d){return g(s),F(i.desc,d)||(i.desc=d),f(d)}),r()()(),n(17,"div",12)(18,"div",13)(19,"span",17),w(20,"i",18),r(),n(21,"p-calendar",19),P("ngModelChange",function(d){return g(s),F(i.fecha_op,d)||(i.fecha_op=d),f(d)}),r()()(),n(22,"div",20)(23,"div",13)(24,"span",21),w(25,"i",22),r(),n(26,"p-inputNumber",23),P("ngModelChange",function(d){return g(s),F(i.cant,d)||(i.cant=d),f(d)}),C("onInput",function(d){return g(s),f(i.operationCant(d))}),r()()(),n(27,"div",20)(28,"div",13)(29,"span",24),w(30,"i",25),r(),n(31,"p-inputNumber",26),P("ngModelChange",function(d){return g(s),F(i.valor,d)||(i.valor=d),f(d)}),C("onInput",function(d){return g(s),f(i.operationVal(d))}),r()()(),n(32,"div",20)(33,"div",13)(34,"span",27),w(35,"i",25),r(),n(36,"p-inputNumber",28),P("ngModelChange",function(d){return g(s),F(i.total,d)||(i.total=d),f(d)}),r()()()(),V(37,ae,4,5,"ng-template",29),r()}t&2&&(p(),m("tableStyle",y(39,Ot))("value",i.info)("rows",i.filas)("loading",i.loading)("columns",i.columnas)("paginator",!0)("showCurrentPageReport",!0)("resizableColumns",!0)("rowsPerPageOptions",y(40,Lt))("globalFilterFields",y(41,At)),p(7),m("fullScreen",!0),p(),N(y(42,jt)),M("visible",i.visible),m("modal",!0)("baseZIndex",1e4)("breakpoints",y(43,Wt))("draggable",!1)("resizable",!1),p(7),M("ngModel",i.desc),p(5),N(y(44,Xt)),M("ngModel",i.fecha_op),m("showIcon",!0)("showButtonBar",!0)("monthNavigator",!0)("yearNavigator",!0)("readonlyInput",!0)("showTransitionOptions","0ms")("hideTransitionOptions","0ms"),p(5),m("showButtons",!0)("min",1)("max",1e3),M("ngModel",i.cant),p(5),m("minFractionDigits",2),M("ngModel",i.valor),p(5),m("minFractionDigits",2),M("ngModel",i.total),m("disabled",i.total_input))},dependencies:[pt,lt,ct,at,K,$,J,Z,H,Y,q,_t,ut,Et,yt,xt,St,Tt,gt,ht,rt,nt,vt,wt,dt,mt,it,Q,tt,et,Ct,bt,ft],styles:[".swal2-container{z-index:20000!important}.margen[_ngcontent-%COMP%]{margin-left:5px}.margen2[_ngcontent-%COMP%]{margin-right:.5rem}.gasto[_ngcontent-%COMP%]{font-weight:700;color:#ff5252}.ingreso[_ngcontent-%COMP%]{font-weight:700;color:#66bb6a}.neutral[_ngcontent-%COMP%]{font-weight:700;color:ivory}.letra[_ngcontent-%COMP%]{font-size:12px}"]});let a=u;return a})();export{Ie as GastosComponent};
