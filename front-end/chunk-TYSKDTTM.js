import{a as Yt}from"./chunk-WAPBH432.js";import{a as te}from"./chunk-XHNQRRQK.js";import{a as Xt}from"./chunk-O5VURVW4.js";import{d as kt,e as Lt,f as Rt,g as zt,i as Zt,j as Jt,k as qt,l as Gt,m as Ut,n as Ht,o as Kt,p as Qt}from"./chunk-A6SNVUCE.js";import{a as It,b as Ft,c as Ot,d as Et,g as Vt,h as Bt,k as At,l as Nt,n as Wt,o as Dt,r as jt,s as $t}from"./chunk-TWZKI4VX.js";import{a as re}from"./chunk-V45YFJOR.js";import{A as vt,B as St,a as ft,b as ht,d as Ct,e as bt,f as xt,o as yt,r as R,s as Z,w as wt,x as Mt,y as Tt,z as Pt}from"./chunk-VE3AD5Y3.js";import{h as pt,i as mt,j as W,k as dt,l as ut,m as _t,n as gt,p as D}from"./chunk-QSIHMZNO.js";import{$ as G,Ac as ct,Cb as C,Db as s,Gb as N,Hb as Y,Ib as X,Kb as tt,Lb as et,Mb as nt,Nb as g,Ob as S,Pb as O,Rb as w,Sb as M,Tb as T,Ub as it,Vb as ot,Wb as V,Xb as at,Ya as l,Yb as rt,Z as q,Za as E,Zb as lt,dc as I,e as ae,f as P,fc as F,gb as K,ia as L,ja as U,jb as x,mb as B,nb as m,qb as z,rb as j,sa as u,sb as A,ta as _,tb as a,tc as st,ub as r,vb as h,yb as Q,za as H,zb as v,zc as $}from"./chunk-II3ZEASU.js";var ce=(o,c,t)=>({"p-togglebutton p-button p-component":!0,"p-button-icon-only":o,"p-highlight":c,"p-disabled":t}),pe=(o,c)=>({"p-button-icon":!0,"p-button-icon-left":o,"p-button-icon-right":c}),me=o=>({$implicit:o});function de(o,c){if(o&1&&h(0,"span",4),o&2){let t=s(2);j(t.checked?t.onIcon:t.offIcon),m("ngClass",rt(4,pe,t.iconPos==="left",t.iconPos==="right")),B("data-pc-section","icon")}}function ue(o,c){if(o&1&&x(0,de,1,7,"span",3),o&2){let t=s();m("ngIf",t.onIcon||t.offIcon)}}function _e(o,c){o&1&&Q(0)}function ge(o,c){if(o&1&&x(0,_e,1,0,"ng-container",5),o&2){let t=s();m("ngTemplateOutlet",t.iconTemplate)("ngTemplateOutletContext",at(2,me,t.checked))}}function fe(o,c){if(o&1&&(a(0,"span",6),g(1),r()),o&2){let t=s();B("data-pc-section","label"),l(),S(t.checked?t.hasOnLabel?t.onLabel:"":t.hasOffLabel?t.offLabel:"")}}var he={provide:ft,useExisting:q(()=>J),multi:!0},J=(()=>{class o{cd;onLabel;offLabel;onIcon;offIcon;ariaLabel;ariaLabelledBy;disabled;style;styleClass;inputId;tabindex=0;iconPos="left";autofocus;onChange=new H;templates;iconTemplate;checked=!1;onModelChange=()=>{};onModelTouched=()=>{};constructor(t){this.cd=t}ngAfterContentInit(){this.templates.forEach(t=>{switch(t.getType()){case"icon":this.iconTemplate=t.template;break;default:this.iconTemplate=t.template;break}})}toggle(t){this.disabled||(this.checked=!this.checked,this.onModelChange(this.checked),this.onModelTouched(),this.onChange.emit({originalEvent:t,checked:this.checked}),this.cd.markForCheck())}onKeyDown(t){switch(t.code){case"Enter":this.toggle(t),t.preventDefault();break;case"Space":this.toggle(t),t.preventDefault();break}}onBlur(){this.onModelTouched()}writeValue(t){this.checked=t,this.cd.markForCheck()}registerOnChange(t){this.onModelChange=t}registerOnTouched(t){this.onModelTouched=t}setDisabledState(t){this.disabled=t,this.cd.markForCheck()}get hasOnLabel(){return this.onLabel&&this.onLabel.length>0}get hasOffLabel(){return this.onLabel&&this.onLabel.length>0}static \u0275fac=function(i){return new(i||o)(E(st))};static \u0275cmp=L({type:o,selectors:[["p-toggleButton"]],contentQueries:function(i,e,n){if(i&1&&X(n,R,4),i&2){let p;tt(p=et())&&(e.templates=p)}},hostAttrs:[1,"p-element"],inputs:{onLabel:"onLabel",offLabel:"offLabel",onIcon:"onIcon",offIcon:"offIcon",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy",disabled:[2,"disabled","disabled",$],style:"style",styleClass:"styleClass",inputId:"inputId",tabindex:[2,"tabindex","tabindex",ct],iconPos:"iconPos",autofocus:[2,"autofocus","autofocus",$]},outputs:{onChange:"onChange"},features:[it([he]),K],decls:4,vars:17,consts:[["role","switch","pRipple","","pAutoFocus","",3,"click","keydown","ngClass","ngStyle","autofocus"],[3,"class","ngClass"],["class","p-button-label",4,"ngIf"],[3,"class","ngClass",4,"ngIf"],[3,"ngClass"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-button-label"]],template:function(i,e){i&1&&(a(0,"div",0),C("click",function(p){return e.toggle(p)})("keydown",function(p){return e.onKeyDown(p)}),x(1,ue,1,1,"span",1)(2,ge,1,4,"ng-container")(3,fe,2,2,"span",2),r()),i&2&&(j(e.styleClass),m("ngClass",lt(13,ce,e.onIcon&&e.offIcon&&!e.hasOnLabel&&!e.hasOffLabel,e.checked,e.disabled))("ngStyle",e.style)("autofocus",e.autofocus),B("tabindex",e.disabled?null:e.tabindex)("aria-checked",e.checked)("aria-labelledby",e.ariaLabelledBy)("aria-label",e.ariaLabel)("data-pc-name","togglebutton")("data-pc-section","root"),l(),A(e.iconTemplate?2:1),l(2),m("ngIf",e.onLabel||e.offLabel))},dependencies:[pt,W,ut,dt,vt,wt],styles:['@layer primeng{.p-button[_ngcontent-%COMP%]{margin:0;display:inline-flex;cursor:pointer;-webkit-user-select:none;user-select:none;align-items:center;vertical-align:bottom;text-align:center;overflow:hidden;position:relative}.p-button-label[_ngcontent-%COMP%]{flex:1 1 auto}.p-button-icon-right[_ngcontent-%COMP%]{order:1}.p-button[_ngcontent-%COMP%]:disabled{cursor:default;pointer-events:none}.p-button-icon-only[_ngcontent-%COMP%]{justify-content:center}.p-button-icon-only[_ngcontent-%COMP%]:after{content:"p";visibility:hidden;clip:rect(0 0 0 0);width:0}.p-button-vertical[_ngcontent-%COMP%]{flex-direction:column}.p-button-icon-bottom[_ngcontent-%COMP%]{order:2}.p-button-group[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]{margin:0}.p-button-group[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]:focus, .p-button-group[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]:focus   .p-button[_ngcontent-%COMP%], .p-buttonset[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]:focus, .p-buttonset[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]:focus   .p-button[_ngcontent-%COMP%]{position:relative;z-index:1}.p-button-group[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]:not(:last-child), .p-button-group[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]:not(:last-child):hover, .p-button-group[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]:not(:last-child)   .p-button[_ngcontent-%COMP%], .p-button-group[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]:not(:last-child)   .p-button[_ngcontent-%COMP%]:hover, .p-buttonset[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]:not(:last-child), .p-buttonset[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]:not(:last-child):hover, .p-buttonset[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]:not(:last-child)   .p-button[_ngcontent-%COMP%], .p-buttonset[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]:not(:last-child)   .p-button[_ngcontent-%COMP%]:hover{border-right:0 none}.p-button-group[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]:not(:first-of-type):not(:last-of-type), .p-button-group[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]:not(:first-of-type):not(:last-of-type)   .p-button[_ngcontent-%COMP%], .p-buttonset[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]:not(:first-of-type):not(:last-of-type), .p-buttonset[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]:not(:first-of-type):not(:last-of-type)   .p-button[_ngcontent-%COMP%]{border-radius:0}.p-button-group[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]:first-of-type:not(:only-of-type), .p-button-group[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]:first-of-type:not(:only-of-type)   .p-button[_ngcontent-%COMP%], .p-buttonset[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]:first-of-type:not(:only-of-type), .p-buttonset[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]:first-of-type:not(:only-of-type)   .p-button[_ngcontent-%COMP%]{border-top-right-radius:0;border-bottom-right-radius:0}.p-button-group[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]:last-of-type:not(:only-of-type), .p-button-group[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]:last-of-type:not(:only-of-type)   .p-button[_ngcontent-%COMP%], .p-buttonset[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]:last-of-type:not(:only-of-type), .p-buttonset[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]:last-of-type:not(:only-of-type)   .p-button[_ngcontent-%COMP%]{border-top-left-radius:0;border-bottom-left-radius:0}p-button[iconpos=right][_ngcontent-%COMP%]   spinnericon[_ngcontent-%COMP%]{order:1}}'],changeDetection:0})}return o})(),ee=(()=>{class o{static \u0275fac=function(i){return new(i||o)};static \u0275mod=U({type:o});static \u0275inj=G({imports:[D,St,Z,Mt,Z]})}return o})();var ne=ae(re());var be=()=>({"min-width":"60rem"}),xe=()=>[5,10,20,50,100],ye=()=>["cliente_fact.cliente","total_fact","fecha_fact"],we=()=>({width:"90vw"}),Me=()=>({"960px":"75vw"}),Te=()=>({"min-width":"50rem"}),Pe=()=>({"margin-left":"5px"});function ve(o,c){if(o&1){let t=v();a(0,"div",35)(1,"span",36),h(2,"i",37),a(3,"input",38),C("input",function(e){u(t),s();let n=nt(2);return _(n.filterGlobal(e.target.value,"contains"))}),r()(),a(4,"p-calendar",39),T("ngModelChange",function(e){u(t);let n=s();return M(n.fecha_datos,e)||(n.fecha_datos=e),_(e)}),C("onSelect",function(e){u(t);let n=s();return _(n.poblarTabla(e))})("onClearClick",function(e){u(t);let n=s();return _(n.poblarTabla(e.target.value))}),r(),a(5,"p-button",40),C("onClick",function(){u(t);let e=s();return _(e.open())}),r(),a(6,"div",41),h(7,"p-button",42),I(8,"number"),r()()}if(o&2){let t=s();l(4),w("ngModel",t.fecha_datos),m("showIcon",!0)("showButtonBar",!0)("monthNavigator",!0)("yearNavigator",!0)("readonlyInput",!0)("showTransitionOptions","0ms")("hideTransitionOptions","0ms"),l(),m("raised",!0)("loading",t.loading)("disabled",t.loading),l(2),Y("label","L. ",F(8,13,t.total_ing,"1.2-2"),"")}}function Se(o,c){o&1&&(a(0,"tr"),h(1,"th",43),a(2,"th",44),g(3,"Cliente "),h(4,"p-sortIcon",45),r(),a(5,"th",46),g(6,"Total "),h(7,"p-sortIcon",47),r(),a(8,"th",48),g(9,"Fecha "),h(10,"p-sortIcon",49),r(),a(11,"th",50),g(12,"Acciones "),h(13,"p-sortIcon",51),r()())}function Ie(o,c){if(o&1){let t=v();a(0,"tr",52)(1,"td"),h(2,"p-button",53),r(),a(3,"td",54),g(4),r(),a(5,"td",54)(6,"div",55),g(7),I(8,"number"),r()(),a(9,"td",54),g(10),I(11,"date"),r(),a(12,"td",54)(13,"p-button",56),C("onClick",function(){let e=u(t).$implicit,n=s();return _(n.deleteFact(e.id_fact))}),r()()()}if(o&2){let t=c.$implicit,i=c.expanded;l(2),m("pRowToggler",t)("text",!0)("rounded",!0)("plain",!0)("icon",i?"pi pi-chevron-down":"pi pi-chevron-right"),l(2),S(t.cliente_fact.cliente),l(3),O(" L. ",F(8,9,t.total_fact,"1.2-2")," "),l(3),S(F(11,12,t.fecha_fact,"yyyy-MM-dd")),l(3),m("rounded",!0)}}function Fe(o,c){o&1&&(a(0,"tr")(1,"th",60),g(2,"Nombre "),h(3,"p-sortIcon",61),r(),a(4,"th",62),g(5,"Cant "),h(6,"p-sortIcon",63),r(),a(7,"th",64),g(8,"Precio "),h(9,"p-sortIcon",65),r(),a(10,"th",66),g(11,"Total "),h(12,"p-sortIcon",67),r()())}function Oe(o,c){if(o&1&&(a(0,"tr")(1,"td",54),g(2),r(),a(3,"td",54),g(4),r(),a(5,"td",54),g(6),I(7,"number"),r(),a(8,"td",54),g(9),I(10,"number"),r()()),o&2){let t=c.$implicit;l(2),S(t.nombre),l(2),S(t.cant),l(2),S(F(7,4,t.precio_u,"1.2-2")),l(3),S(F(10,7,t.total,"1.2-2"))}}function Ee(o,c){o&1&&(a(0,"tr")(1,"td",68),g(2,"No hay facturas."),r()())}function Ve(o,c){if(o&1&&(a(0,"tr")(1,"td",57)(2,"div",58)(3,"p-table",59),x(4,Fe,13,0,"ng-template",5)(5,Oe,11,10,"ng-template",6)(6,Ee,3,0,"ng-template",32),r()()()()),o&2){let t=c.$implicit;l(3),m("value",t.items_fact)}}function Be(o,c){if(o&1&&(a(0,"div",69)(1,"h4"),g(2),r()()),o&2){let t=s();l(2),S(t.titleModal)}}function ke(o,c){if(o&1){let t=v();a(0,"div",16)(1,"div",17)(2,"span",70),h(3,"i",71),r(),a(4,"input",72),T("ngModelChange",function(e){u(t);let n=s();return M(n.cliente_fact,e)||(n.cliente_fact=e),_(e)}),r()()()}if(o&2){let t=s();l(4),w("ngModel",t.cliente_fact)}}function Le(o,c){if(o&1){let t=v();a(0,"div",16)(1,"p-dropdown",73),T("ngModelChange",function(e){u(t);let n=s();return M(n.client,e)||(n.client=e),_(e)}),C("onChange",function(e){u(t);let n=s();return _(n.handleOnChange(e))}),r()()}if(o&2){let t=s();l(),m("options",t.listClient),w("ngModel",t.client),m("filter",!0)("showClear",!0)}}function Ae(o,c){if(o&1){let t=v();a(0,"div",35)(1,"p-dropdown",74),T("ngModelChange",function(e){u(t);let n=s();return M(n.prod,e)||(n.prod=e),_(e)}),C("onChange",function(e){u(t);let n=s();return _(n.addItemProd(e.value))}),r(),a(2,"p-button",75),C("onClick",function(){u(t);let e=s();return _(e.addItem())}),r(),a(3,"p-button",76),C("onClick",function(){u(t);let e=s();return _(e.clearItems())}),r()()}if(o&2){let t=s();l(),z(V(8,Pe)),m("options",t.listProd),w("ngModel",t.prod),m("filter",!0)("showClear",!0),l(),m("raised",!0),l(),m("raised",!0)}}function Ne(o,c){if(o&1&&(a(0,"th",78),g(1),r()),o&2){let t=c.$implicit;l(),S(t.header)}}function We(o,c){if(o&1&&(a(0,"tr"),x(1,Ne,2,1,"th",77),r()),o&2){let t=c.$implicit;l(),m("ngForOf",t)}}function De(o,c){if(o&1){let t=v();a(0,"input",86),T("ngModelChange",function(e){u(t);let n=s(2).$implicit;return M(n.nombre_item,e)||(n.nombre_item=e),_(e)}),r()}if(o&2){let t=s(2).$implicit;w("ngModel",t.nombre_item)}}function Re(o,c){if(o&1&&g(0),o&2){let t=s(2).$implicit;O(" ",t.nombre_item," ")}}function ze(o,c){if(o&1){let t=v();a(0,"p-inputNumber",87),T("ngModelChange",function(e){u(t);let n=s(2).$implicit;return M(n.cant_item,e)||(n.cant_item=e),_(e)}),C("onInput",function(e){u(t);let n=s(2).$implicit,p=s();return _(p.operationCant(e,n))}),r()}if(o&2){let t=s(2).$implicit;m("showButtons",!0)("min",1)("max",1e3),w("ngModel",t.cant_item)}}function je(o,c){if(o&1&&g(0),o&2){let t=s(2).$implicit;O(" ",t.cant_item," ")}}function $e(o,c){if(o&1){let t=v();a(0,"p-inputNumber",88),T("ngModelChange",function(e){u(t);let n=s(2).$implicit;return M(n.precio_item,e)||(n.precio_item=e),_(e)}),C("onInput",function(e){u(t);let n=s(2).$implicit,p=s();return _(p.operationPrecio(e,n))}),r()}if(o&2){let t=s(2).$implicit;m("minFractionDigits",2),w("ngModel",t.precio_item)}}function Ze(o,c){if(o&1&&(g(0),I(1,"number")),o&2){let t=s(2).$implicit;O(" L. ",F(1,1,t.precio_item,"1.2-2")," ")}}function Je(o,c){if(o&1&&(a(0,"td",81)(1,"p-cellEditor"),x(2,De,1,1,"ng-template",82)(3,Re,1,1,"ng-template",83),r()(),a(4,"td",84)(5,"p-cellEditor"),x(6,ze,1,4,"ng-template",82)(7,je,1,1,"ng-template",83),r()(),a(8,"td",85)(9,"p-cellEditor"),x(10,$e,1,2,"ng-template",82)(11,Ze,2,4,"ng-template",83),r()()),o&2){let t=s().$implicit;m("pEditableColumn",t.nombre_item),l(4),m("pEditableColumn",t.cant_item),l(4),m("pEditableColumn",t.precio_item)}}function qe(o,c){if(o&1){let t=v();a(0,"p-inputNumber",87),T("ngModelChange",function(e){u(t);let n=s(2).$implicit;return M(n.cant_item,e)||(n.cant_item=e),_(e)}),C("onInput",function(e){u(t);let n=s(2).$implicit,p=s();return _(p.operationCant(e,n))}),r()}if(o&2){let t=s(2).$implicit;N("max",t.cant_total_item),m("showButtons",!0)("min",1),w("ngModel",t.cant_item)}}function Ge(o,c){if(o&1&&g(0),o&2){let t=s(2).$implicit;O(" ",t.cant_item," ")}}function Ue(o,c){if(o&1&&(a(0,"td",54),g(1),r(),a(2,"td",84)(3,"p-cellEditor"),x(4,qe,1,4,"ng-template",82)(5,Ge,1,1,"ng-template",83),r()(),a(6,"td",54),g(7),I(8,"number"),r()),o&2){let t=s().$implicit;l(),S(t.nombre_item),l(),m("pEditableColumn",t.cant_item),l(5),O("L. ",F(8,3,t.precio_item,"1.2-2"),"")}}function He(o,c){if(o&1){let t=v();a(0,"tr",52),x(1,Je,12,3)(2,Ue,9,6),a(3,"td",54),g(4),I(5,"number"),r(),a(6,"td",54)(7,"p-toggleButton",79),T("ngModelChange",function(e){let n=u(t).$implicit;return M(n.impuesto_item,e)||(n.impuesto_item=e),_(e)}),C("onChange",function(e){u(t);let n=s();return _(n.handleOnChangeToggleImp(e))}),r()(),a(8,"td",54)(9,"p-button",80),C("onClick",function(){let e=u(t).$implicit,n=s();return _(n.deleteItem(e))}),r()()()}if(o&2){let t=c.$implicit;l(),A(t.tipo?1:2),l(3),O("L. ",F(5,5,t.total_item,"1.2-2"),""),l(3),m("disabled",t.tipo==!0?"false":"true"),w("ngModel",t.impuesto_item),l(2),m("rounded",!0)}}function Ke(o,c){if(o&1&&(a(0,"tr")(1,"td")(2,"h4"),g(3,"No hay items"),r()()()),o&2){let t=c.$implicit;l(),B("colspan",t.length)}}function Qe(o,c){if(o&1&&(a(0,"div",12)(1,"div",89)(2,"div",11)(3,"ul",90)(4,"li",91)(5,"div")(6,"span",92),g(7,"Sub Total"),r()(),a(8,"div",93)(9,"span",94),g(10),I(11,"number"),r()()(),a(12,"li",91)(13,"div")(14,"span",92),g(15,"Impuesto(15%)"),r()(),a(16,"div",95)(17,"span",96),g(18),I(19,"number"),r()()(),a(20,"li",91)(21,"div")(22,"span",92),g(23,"Total a Pagar"),r()(),a(24,"div",95)(25,"span",94),g(26),I(27,"number"),r()()()()()()()),o&2){let t=s();l(10),O("L. ",F(11,3,t.sub_total_fact,"1.2-2")," "),l(8),O("L. ",F(19,6,t.tax_fact,"1.2-2"),""),l(8),O("L. ",F(27,9,t.total_fact,"1.2-2"),"")}}function Ye(o,c){if(o&1){let t=v();a(0,"p-button",100),C("onClick",function(){u(t);let e=s(2);return _(e.agregarFact())}),r()}if(o&2){let t=s(2);N("label",t.textBottom),m("raised",!0)}}function Xe(o,c){if(o&1){let t=v();x(0,Ye,1,2,"p-button",97),a(1,"p-button",98),C("onClick",function(){u(t);let e=s();return _(e.cleanFactura())}),r(),a(2,"p-button",99),C("onClick",function(){u(t);let e=s();return _(e.closeDialog())}),r()}if(o&2){let t=s();m("ngIf",t.op=="Add"),l(),N("label",t.btnClean),m("raised",!0),l(),m("raised",!0)}}var b=ne.default.mixin({showClass:{popup:`
      animate__animated
      animate__fadeInUp
      animate__faster
    `},hideClass:{popup:`
      animate__animated
      animate__fadeOutDown
      animate__faster
    `}}),$n=(()=>{let c=class c{constructor(i,e,n,p,f){this.apiFactura=i,this.apiClientes=e,this.apiProd=n,this.spinner=p,this.primengConfig=f,this.client=null,this.prod=null,this.filas=0,this.filasItems=0,this.total_ing=0,this.columnasItems=[],this.itemsArr=[],this.info=[],this.infoClientes=[],this.infoProd=[],this.loading=!1,this.titleModal="Nueva Factura",this.textBottom="Procesar",this.lbBtnModal="Cancelar",this.btnClean="Limpiar",this.op="Add",this.href="",this.visible=!1,this.checked=!1,this.iconOff="pi pi-user-plus",this.iconOn="pi pi-users",this.id_fact=0,this.cliente_fact="",this.direccionClient="",this.correoClient="",this.contactoClient="",this.rtnClient="",this.primengConfig.setTranslation({dayNames:["Domingo","Lunes","Martes","Mi\xE9rcoles","Jueves","Viernes","S\xE1bado"],dayNamesShort:["Dom","Lun","Mar","Mi\xE9","Jue","Vie","S\xE1b"],dayNamesMin:["Do","Lu","Ma","Mi","Ju","Vi","Sa"],monthNames:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],monthNamesShort:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],today:"Hoy",clear:"Todos las facturas"}),this.filas=10,this.filasItems=10,this.columnasItems=[{field:"nombre_item",header:"Nombre"},{field:"cant_item",header:"Cantidad"},{field:"precio_item",header:"Precio"},{field:"total_item",header:"Total"},{field:"impuesto_item",header:"ISV"},{field:"",header:"Eliminar"}]}ngOnInit(){return P(this,null,function*(){this.primengConfig.ripple=!0,this.load(!0),yield this.poblarTabla(),yield this.listarClientes(),yield this.getProd(),this.load(!1)})}onRowExpand(i){}onRowCollapse(i){}open(){this.clean(),this.titleModal="Nueva Factura",this.textBottom="Procesar",this.op="Add",this.showDialog()}handleOnChange(i){if(i.value){let e=this.infoClientes.findIndex(n=>n.id===i.value);this.direccionClient=this.infoClientes[e].direccion,this.contactoClient=this.infoClientes[e].contacto,this.correoClient=this.infoClientes[e].correo,this.rtnClient=this.infoClientes[e].rtn}else this.cleanClientes()}handleOnChangeToggle(i){this.cleanClientes()}handleOnChangeToggleImp(i){this.sumaSubTotal()}addItem(){this.itemsArr.push({id_item:0,nombre_item:"",cant_item:1,cant_total_item:1,precio_item:0,total_item:0,impuesto_item:!0,tipo:!0})}addItemProd(i){return P(this,null,function*(){if(i){let e=yield this.infoProd[this.infoProd.findIndex(y=>y.id_prod==i)],n=this.listProd.findIndex(y=>y.value==i),f=this.listProd[n].label.split("-",2),d=Number(f[1])-1;d>=0?(this.listProd[n].label=e.nombre_prod+" - "+d.toString(),this.itemsArr.push({id_item:e.id_prod,nombre_item:e.nombre_prod,cant_item:1,cant_total_item:Number(e.cant_prod),precio_item:Number(e.precio_prod),total_item:Number(e.precio_prod),impuesto_item:!0,tipo:!1}),this.sumaSubTotal()):b.fire("Cuidado!",`El producto ${e.nombre_prod} tiene ${f[1]} en existencia!`,"warning")}})}deleteItem(i){let e=this.itemsArr.indexOf(i),n=this.itemsArr[e].cant_item;if(e!==-1){if(this.itemsArr.splice(e,1),!i.tipo){this.prod=this.listProd[0].value;let p=this.listProd.findIndex(k=>k.value==i.id_item),d=this.listProd[p].label.split("-",2),y=Number(d[1])+Number(n);this.listProd[p].label=i.nombre_item+" - "+y.toString()}this.sumaSubTotal()}}operationCant(i,e){if(i){this.prod=this.listProd[0].value;let n=this.infoProd[this.infoProd.findIndex(f=>f.id_prod==e.id_item)],p=this.itemsArr.indexOf(e);if(p!==-1){this.itemsArr[p].total_item=this.itemsArr[p].precio_item*Number(i.value);let f=this.listProd.findIndex(y=>y.value==e.id_item),d=this.itemsArr.reduce((y,{id_item:k,cant_item:ie},oe,tn)=>k==e.id_item&&oe!=p?y+ie:y,0);if(n){let y=Number(n.cant_prod)-Number(i.value)-Number(d);y>=0?(this.listProd[f].label=e.nombre_item+" - "+y.toString(),this.sumaSubTotal()):(this.itemsArr[p].cant_item-=1,this.itemsArr[p].total_item=this.itemsArr[p].precio_item*this.itemsArr[p].cant_item,this.sumaSubTotal(),b.fire("Cuidado!",`Estas sobrepasando la cantidad de ${n.nombre_prod} que hay en existencia!`,"warning"))}else this.sumaSubTotal()}}}operationPrecio(i,e){if(i){let n=this.itemsArr.indexOf(e);n!==-1&&(this.itemsArr[n].total_item=this.itemsArr[n].cant_item*Number(i.value),this.sumaSubTotal())}}sumaSubTotal(){return P(this,null,function*(){let i=yield this.itemsArr.reduce((n,p)=>n+p.total_item,0),e=yield this.itemsArr.reduce((n,p)=>n+(p.impuesto_item?p.total_item:0),0);this.tax_fact=e*.15,this.sub_total_fact=i-this.tax_fact,this.total_fact=i})}clearItems(){this.itemsArr=[],this.sub_total_fact=0,this.tax_fact=0,this.total_fact=0,this.pago_fact=0,this.saldo_fact=0,this.resetProd()}resetProd(){this.listProd=[{value:null,label:"Seleccione Producto"}],this.infoProd.forEach((i,e)=>{this.listProd.push({value:i.id_prod,label:i.nombre_prod+" - "+i.cant_prod})}),this.prod=this.listProd[0].value}poblarTabla(i=void 0){return P(this,null,function*(){this.fecha_datos=i,this.load(!0),i==null||i==""?this.apiFactura.getFacturas().subscribe(e=>P(this,null,function*(){this.total_ing=e.reduce((n,p)=>n+p.total_fact,0),this.info=e}),e=>{b.fire("Error!",`${e.message}`,"error")},()=>this.load(!1)):this.apiFactura.getFacturasByDate(this.formatearFecha(i).fecha).subscribe(e=>P(this,null,function*(){this.total_ing=e.reduce((n,p)=>n+p.total_fact,0),this.info=e}),e=>{b.fire("Error!",`${e.message}`,"error")},()=>this.load(!1))})}listarClientes(){return P(this,null,function*(){this.load(!0),this.listClient=[{value:null,label:"Seleccione Cliente"}],this.apiClientes.getClients().subscribe(i=>{this.infoClientes=i;for(let e=0;e<i.length;e++)this.listClient.push({value:i[e].id,label:i[e].nombre});this.client=this.listClient[0].value},i=>{b.fire("Error!",`${i.message}`,"error")},()=>this.load(!1))})}getProd(){return P(this,null,function*(){this.load(!0),this.listProd=[{value:null,label:"Seleccione Producto"}],this.apiProd.getProducts().subscribe(i=>{this.infoProd=i;for(let e=0;e<i.length;e++)this.listProd.push({value:i[e].id_prod,label:i[e].nombre_prod+" - "+i[e].cant_prod});this.prod=this.listProd[0].value},i=>{b.fire("Error!",`${i.message}`,"error")},()=>this.load(!1))})}agregarFact(){return P(this,null,function*(){this.cliente_fact==""&&this.client==null||this.itemsArr.length==0?b.fire({position:"bottom-end",icon:"warning",title:"Debe llenar los campos obligatorios(Cliente, Items)!",showConfirmButton:!1,timer:2e3,toast:!0}):b.fire({title:"Factura",input:"number",inputLabel:"Ingrese cantidad con la que paga la factura.",inputAttributes:{autocapitalize:"off"},showCancelButton:!0,cancelButtonText:'<i class="fa fa-ban" aria-hidden="true"></i> Cancelar',cancelButtonColor:"#d33",confirmButtonText:'<i class="fa fa-check" aria-hidden="true"></i> Pagar',confirmButtonColor:"#22C55E",showLoaderOnConfirm:!0,inputPlaceholder:"L. 00.00",width:"35em",preConfirm:i=>{if(!i)b.showValidationMessage("Debe llenar el campo.");else{if(Number(this.total_fact)<=Number(i))return i;b.showValidationMessage(`El monto ${i} es menor que el total a pagar.`)}},allowOutsideClick:()=>!b.isLoading()}).then(i=>P(this,null,function*(){i.isConfirmed&&b.fire({title:"Factura Procesada",text:`Cambio a entregar L.${Number(i.value)-this.total_fact}`,icon:"success"}).then(e=>{let n=this.infoClientes[this.infoClientes.findIndex(f=>f.id==this.client)],p={cliente_fact:{id:this.client||0,cliente:this.cliente_fact||n.nombre,correo:this.correoClient,contacto:this.contactoClient,direccion:this.direccionClient,rtn:this.rtnClient},items_fact:this.itemsArr.map((f,d)=>({nombre:f.nombre_item,cant:f.cant_item,precio_u:f.precio_item,total:f.total_item})),total_fact:this.total_fact};this.load(!0),this.apiFactura.insertFactura(p).subscribe(f=>{f.status?b.fire({position:"top-end",icon:"success",title:f.mgs,showConfirmButton:!1,timer:2e3}).then(()=>P(this,null,function*(){this.clearItems(),yield this.poblarTabla(this.fecha_datos),yield this.listarClientes(),yield this.getProd(),this.clean()})):b.fire("Cuidado!",f.mgs,"warning")},f=>{b.fire("Error!",`${f.message}`,"error")},()=>(this.load(!1),this.closeDialog()))})}))})}deleteFact(i){return P(this,null,function*(){b.fire({title:"Esta seguro de realizar esta accion?",text:"Se va a eliminar la factura!",icon:"warning",showCancelButton:!0,confirmButtonText:"Eliminar",confirmButtonColor:"#d33",cancelButtonText:"Cancelar",cancelButtonColor:"#B9B6B5"}).then(e=>P(this,null,function*(){e.value&&(this.load(!0),this.apiFactura.deleteFactura(i).subscribe(n=>{n.status?b.fire({position:"top-end",icon:"success",title:n.mgs,showConfirmButton:!1,timer:2e3}).then(()=>P(this,null,function*(){yield this.poblarTabla(this.fecha_datos),yield this.getProd(),this.clean()})):b.fire("Cuidado!",n.mgs,"warning")},n=>{b.fire("Error!",`${n.message}`,"error")},()=>(this.load(!1),this.closeDialog())))}))})}clean(){this.direccionClient="",this.contactoClient="",this.correoClient="",this.rtnClient="",this.cliente_fact="",this.sub_total_fact=0,this.tax_fact=0,this.total_fact=0,this.pago_fact=0,this.saldo_fact=0,this.items_fact="",this.client=this.listClient[0].value,this.prod=this.listProd[0].value,this.fecha_fact=void 0}cleanClientes(){this.direccionClient="",this.contactoClient="",this.correoClient="",this.rtnClient="",this.cliente_fact="",this.client=this.listClient[0].value}cleanFactura(){this.direccionClient="",this.contactoClient="",this.correoClient="",this.rtnClient="",this.cliente_fact="",this.items_fact="",this.client=this.listClient[0].value,this.fecha_fact=void 0,this.clearItems()}formatearFecha(i){let e=this.addZero(i.getHours()),n=this.addZero(i.getMinutes()),p=this.addZero(i.getSeconds()),f=i.getFullYear(),d=this.addZero(i.getMonth()+1),y=this.addZero(i.getDate());return{completo:f+"-"+d+"-"+y+" "+e+":"+n+":"+p,fecha:f+"-"+d+"-"+y,hora:e+":"+n+":"+p}}addZero(i){return i<10&&(i="0"+i),i}showDialog(){this.visible=!0}closeDialog(){this.visible=!1}load(i){i?(this.loading=!0,this.spinner.show()):(this.loading=!1,this.spinner.hide())}};c.\u0275fac=function(e){return new(e||c)(E(Yt),E(Xt),E(te),E(It),E(yt))},c.\u0275cmp=L({type:c,selectors:[["app-facturacion"]],standalone:!0,features:[ot],decls:45,vars:43,consts:[["dt",""],["dtItems",""],[1,"card",2,"text-align","center"],["dataKey","id_fact","columnResizeMode","expand","currentPageReportTemplate","Mostrando {first} a {last} de {totalRecords} facturas",3,"onRowExpand","onRowCollapse","tableStyle","value","rows","loading","paginator","showCurrentPageReport","resizableColumns","rowsPerPageOptions","globalFilterFields"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["bdColor","rgba(0, 0, 0, 0.8)","size","large","color","#fff","type","ball-atom",3,"fullScreen"],["header","Header",3,"visibleChange","visible","modal","baseZIndex","breakpoints","draggable","resizable"],["ng-template","","pTemplate","header"],[1,"card"],[1,"p-fluid","p-formgrid","grid"],[1,"field","col-12","md:col-2"],["onLabel","Existe","offLabel","Nuevo","styleClass","w-9rem",3,"ngModelChange","onChange","ngModel","onIcon","offIcon"],["class","field col-12 md:col-5",4,"ngIf"],[1,"field","col-12","md:col-5"],[1,"p-inputgroup"],["tooltipPosition","bottom","pTooltip","Direccion",1,"p-inputgroup-addon"],[1,"pi","pi-map-marker"],["id","float-input","rows","3","cols","30","pInputTextarea","",3,"ngModelChange","ngModel","disabled"],[1,"field","col-12","md:col-3"],["tooltipPosition","bottom","pTooltip","Correo",1,"p-inputgroup-addon"],[1,"pi","pi-send"],["type","text","pInputText","","placeholder","Correo",3,"ngModelChange","ngModel","disabled"],["tooltipPosition","bottom","pTooltip","Contacto",1,"p-inputgroup-addon"],[1,"pi","pi-phone"],["type","text","pInputText","","placeholder","Contacto",3,"ngModelChange","ngModel","disabled"],["tooltipPosition","bottom","pTooltip","RTN",1,"p-inputgroup-addon"],[1,"pi","pi-id-card"],["type","text","pInputText","","placeholder","RTN",3,"ngModelChange","ngModel","disabled"],["styleClass","p-datatable-gridlines p-datatable-striped","columnResizeMode","expand","scrollHeight","300px",3,"tableStyle","value","rows","columns","showCurrentPageReport","resizableColumns"],["pTemplate","emptymessage"],["pTemplate","summary"],["pTemplate","footer"],[1,"mr-3",2,"display","flex"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["type","text","pInputText","","size","20","placeholder","B\xFAsqueda...",2,"width","auto!important",3,"input"],["dateFormat","yy-mm-dd","yearRange","2000:2050","placeholder","Todas las facturas","appendTo","body",1,"margen",3,"ngModelChange","onSelect","onClearClick","ngModel","showIcon","showButtonBar","monthNavigator","yearNavigator","readonlyInput","showTransitionOptions","hideTransitionOptions"],["pTooltip","Nueva factura","tooltipPosition","bottom","label","Nueva Factura","icon","pi pi-external-link",1,"p-button-info","margen",3,"onClick","raised","loading","disabled"],[1,"flex","flex-wrap","justify-content-end","gap-2",2,"flex","auto"],["icon","pi pi-spin pi-wallet","pTooltip","Total facturas","tooltipPosition","bottom","severity","success","text","",3,"label"],[1,"text-center",2,"width","5rem"],["pSortableColumn","cliente_fact.cliente",1,"text-center"],["field","cliente_fact.cliente"],["pSortableColumn","cliente_fact.total_fact",1,"text-center"],["field","cliente_fact.total_fact"],["pSortableColumn","cliente_fact.fecha_fact",1,"text-center"],["field","cliente_fact.fecha_fact"],["pSortableColumn","acciones",1,"text-center"],["field","acciones"],[1,"animate__animated","animate__fadeInLeft"],["type","button","pRipple","",3,"pRowToggler","text","rounded","plain","icon"],[1,"text-center"],[1,"ingreso"],["pTooltip","Eliminar Factura","tooltipPosition","bottom","icon","pi pi-trash","severity","danger",1,"margen2",3,"onClick","rounded"],["colspan","7"],[1,"p-3"],["dataKey","nombre",3,"value"],["pSortableColumn","nombre",1,"text-center"],["field","nombre"],["pSortableColumn","cant",1,"text-center"],["field","cant"],["pSortableColumn","precio_u",1,"text-center"],["field","precio_u"],["pSortableColumn","total",1,"text-center"],["field","total"],["colspan","5"],[1,"inline-flex","align-items-center","justify-content-center","gap-2"],["tooltipPosition","bottom","pTooltip","Cliente",1,"p-inputgroup-addon"],[1,"pi","pi-user"],["type","text","pInputText","","placeholder","Cliente",3,"ngModelChange","ngModel"],["appendTo","body","filterBy","label","placeholder","Seleccione Cliente",3,"ngModelChange","onChange","options","ngModel","filter","showClear"],["filterBy","label","placeholder","Seleccione Producto","appendTo","body",3,"ngModelChange","onChange","options","ngModel","filter","showClear"],["pTooltip","Nuevo Item","tooltipPosition","bottom","label","Nuevo Item","icon","pi pi-plus","severity","success",1,"margen",3,"onClick","raised"],["pTooltip","Limpiar Items","tooltipPosition","bottom","label","Limpiar","icon","pi pi-eraser","severity","secondary",1,"margen",3,"onClick","raised"],["pResizableColumn","","style","width: 11em","class","text-center",4,"ngFor","ngForOf"],["pResizableColumn","",1,"text-center",2,"width","11em"],["onLabel","Si","offLabel","No","styleClass","w-4rem",3,"ngModelChange","onChange","disabled","ngModel"],["pTooltip","Eliminar Item","tooltipPosition","bottom","icon","pi pi-times","severity","danger",1,"margen2",3,"onClick","rounded"],["pEditableColumnField","nombre_item",1,"text-center",3,"pEditableColumn"],["pTemplate","input"],["pTemplate","output"],["pEditableColumnField","cant_item",1,"text-center",3,"pEditableColumn"],["pEditableColumnField","precio_item",1,"text-center",3,"pEditableColumn"],["pInputText","","type","text",3,"ngModelChange","ngModel"],[3,"ngModelChange","onInput","showButtons","min","max","ngModel"],["mode","decimal","locale","en-US",3,"ngModelChange","onInput","minFractionDigits","ngModel"],[1,"field","col-12","md:col-6"],[1,"list-none","p-0","m-0"],[1,"flex","flex-column","md:flex-row","md:align-items-center","md:justify-content-between","mb-4"],[1,"text-900","font-medium","mr-2","mb-1","md:mb-0"],[1,"mt-2","md:mt-0","flex","align-items-center"],[1,"text-white-500","ml-3","font-medium"],[1,"mt-2","md:mt-0","ml-0","md:ml-8","flex","align-items-center"],[1,"text-green-500","ml-3","font-medium"],["icon","pi pi-spin pi-sync","severity","primary",3,"raised","label","onClick",4,"ngIf"],["icon","pi pi-eraser","severity","secondary",3,"onClick","raised","label"],["icon","pi pi-times","label","Cancelar","severity","danger",3,"onClick","raised"],["icon","pi pi-spin pi-sync","severity","primary",3,"onClick","raised","label"]],template:function(e,n){if(e&1){let p=v();a(0,"div",2)(1,"p-table",3,0),C("onRowExpand",function(d){return u(p),_(n.onRowExpand(d))})("onRowCollapse",function(d){return u(p),_(n.onRowCollapse(d))}),x(3,ve,9,16,"ng-template",4)(4,Se,14,0,"ng-template",5)(5,Ie,14,15,"ng-template",6)(6,Ve,7,1,"ng-template",7),r()(),h(7,"ngx-spinner",8),a(8,"p-dialog",9),T("visibleChange",function(d){return u(p),M(n.visible,d)||(n.visible=d),_(d)}),x(9,Be,3,1,"ng-template",10),a(10,"div",11)(11,"div",12)(12,"div",13)(13,"p-toggleButton",14),T("ngModelChange",function(d){return u(p),M(n.checked,d)||(n.checked=d),_(d)}),C("onChange",function(d){return u(p),_(n.handleOnChangeToggle(d))}),r()(),x(14,ke,5,1,"div",15)(15,Le,2,4,"div",15),a(16,"div",16)(17,"div",17)(18,"span",18),h(19,"i",19),r(),a(20,"textarea",20),T("ngModelChange",function(d){return u(p),M(n.direccionClient,d)||(n.direccionClient=d),_(d)}),r()()(),a(21,"div",21)(22,"div",17)(23,"span",22),h(24,"i",23),r(),a(25,"input",24),T("ngModelChange",function(d){return u(p),M(n.correoClient,d)||(n.correoClient=d),_(d)}),r()()(),a(26,"div",21)(27,"div",17)(28,"span",25),h(29,"i",26),r(),a(30,"input",27),T("ngModelChange",function(d){return u(p),M(n.contactoClient,d)||(n.contactoClient=d),_(d)}),r()()(),a(31,"div",21)(32,"div",17)(33,"span",28),h(34,"i",29),r(),a(35,"input",30),T("ngModelChange",function(d){return u(p),M(n.rtnClient,d)||(n.rtnClient=d),_(d)}),r()()()()(),a(36,"div",11)(37,"p-table",31,1),x(39,Ae,4,9,"ng-template",4)(40,We,2,1,"ng-template",5)(41,He,10,8,"ng-template",6)(42,Ke,4,1,"ng-template",32)(43,Qe,28,12,"ng-template",33),r()(),x(44,Xe,3,4,"ng-template",34),r()}e&2&&(l(),m("tableStyle",V(37,be))("value",n.info)("rows",n.filas)("loading",n.loading)("paginator",!0)("showCurrentPageReport",!0)("resizableColumns",!0)("rowsPerPageOptions",V(38,xe))("globalFilterFields",V(39,ye)),l(6),m("fullScreen",!0),l(),z(V(40,we)),w("visible",n.visible),m("modal",!0)("baseZIndex",1e4)("breakpoints",V(41,Me))("draggable",!1)("resizable",!1),l(5),w("ngModel",n.checked),m("onIcon",n.iconOn)("offIcon",n.iconOff),l(),m("ngIf",!n.checked),l(),m("ngIf",n.checked),l(5),w("ngModel",n.direccionClient),m("disabled",n.checked),l(5),w("ngModel",n.correoClient),m("disabled",n.checked),l(5),w("ngModel",n.contactoClient),m("disabled",n.checked),l(5),w("ngModel",n.rtnClient),m("disabled",n.checked),l(2),m("tableStyle",V(42,Te))("value",n.itemsArr)("rows",n.filasItems)("columns",n.columnasItems)("showCurrentPageReport",!0)("resizableColumns",!0))},dependencies:[Et,R,Qt,Zt,Jt,Gt,Ut,Ht,Kt,qt,D,mt,W,gt,_t,Dt,Wt,xt,ht,Ct,bt,Nt,At,Lt,kt,$t,jt,Vt,Pt,Tt,zt,Rt,Ot,Ft,Bt,ee,J],styles:[".swal2-container{z-index:20000!important}.margen[_ngcontent-%COMP%]{margin-left:5px}.margen2[_ngcontent-%COMP%]{margin-right:.5rem}.ingreso[_ngcontent-%COMP%]{font-weight:700;color:#66bb6a}"]});let o=c;return o})();export{$n as FacturacionComponent};
